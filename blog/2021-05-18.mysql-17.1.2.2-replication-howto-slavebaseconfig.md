17.1.2.2 [设置副本配置](https://dev.mysql.com/doc/refman/8.0/en/replication-howto-slavebaseconfig.html)
===
[fdj32.github.io](https://fdj32.github.io)  
每个复制副本都必须有一个唯一的服务器ID，由server_id系统变量指定。如果要设置多个副本，则每个副本必须具有唯一的server_id值，该值与源副本和任何其他副本的服务器id值不同。如果尚未设置复制副本的服务器ID，或者当前值与为源或另一个复制副本选择的值冲突，则必须对其进行更改。

默认服务器id值为1。您可以通过发出如下语句动态更改server_id值：
```
SET GLOBAL server_id = 21;
```
请注意，服务器ID的值为0会阻止复制副本连接到源。如果该服务器ID值（在早期版本中是默认值）是以前设置的，则必须重新启动服务器以使用新的非零服务器ID初始化复制副本。否则，更改服务器ID时不需要重新启动服务器，除非进行了其他需要重新启动的配置更改。例如，如果在服务器上禁用了二进制日志记录，并且您希望为副本启用它，则需要重新启动服务器才能启用此功能。

如果要关闭副本服务器，可以编辑配置文件的[mysqld]部分以指定唯一的服务器ID。例如：
```
[mysqld]
server-id=21
```
默认情况下，所有服务器上都启用二进制日志记录。复制副本不需要启用二进制日志才能进行复制。但是，副本上的二进制日志意味着副本的二进制日志可用于数据备份和崩溃恢复。启用了二进制日志记录的副本也可以用作更复杂的复制拓扑的一部分。例如，您可能希望使用以下链式排列设置复制服务器：
```
A -> B -> C
```
这里，A用作副本B的源，B用作副本C的源。要使其工作，B必须同时是源和副本。从A接收到的更新必须由B记录到其二进制日志中，以便传递给C。除了二进制日志记录之外，此复制拓扑还需要启用log_slave_updates系统变量。启用副本更新后，副本将从源接收并由副本的SQL线程执行的更新写入副本自己的二进制日志。默认情况下启用log_slave_updates系统变量。

如果需要在副本上禁用二进制日志记录或副本更新日志记录，可以通过为副本指定--skip-log-bin和--log-slave-updates=OFF选项来实现。如果决定在复制副本上重新启用这些功能，请删除相关选项并重新启动服务器。