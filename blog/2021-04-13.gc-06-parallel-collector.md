[Garbage Collection Tuning](https://docs.oracle.com/en/java/javase/16/gctuning/introduction-garbage-collection-tuning.html)
===
[fdj32.github.io](https://fdj32.github.io)  
# 6. [并行收集器](https://docs.oracle.com/en/java/javase/16/gctuning/parallel-collector1.html)
并行收集器（在这里也被引用为吞吐量收集器）是一个分代收集器，与串行收集器类似。串行收集器和并行收集器的主要区别是，并行收集器有多个线程被用于加速垃圾收集。

并行收集器使用命令行选项 -XX:+UseParallelGC 开启。默认地，使用这个选项，小型和大型收集都是并行运行，极大地降低垃圾收集的开销。

话题：
- <a href="#gc6a">并行收集器的垃圾收集线程数</a>
- <a href="#gc6b">并行收集器的分代安排</a>
- <a href="#gc6c">并行收集器的人机设计</a>
  - <a href="#gc6c1">设置并行收集器行为的选项</a>
  - <a href="#gc6c2">并行收集器目标的优先级</a>
  - <a href="#gc6c3">并行收集器分代容量调整</a>
  - <a href="#gc6c4">并行收集器默认堆容量</a>
    - <a href="#gc6c4a">并行收集器的初始堆容量和最大堆容量说明</a>
- <a href="#gc6d">并行收集器时间过长和内存溢出错误</a>
- <a href="#gc6e">衡量并行收集器</a>

## <span id="gc6a">并行收集器的垃圾收集线程数</span>
在一台有<N>(N>8)个硬件线程的机器上，并行收集器使用<N>的固定一部分作为垃圾收集线程数。

当<N>比较大时，这个部分接近于5/8。当<N>小于8，这个数取<N>。在已选平台上，这个比例掉到5/16。这个指定的垃圾收集器线程能被调整，使用一个命令行选项(后续会介绍到)。在一台只有一个处理器的主机上，并行收集器可能不会表现得像串行收集器那样，因为并行处理需要一部分开销(例如同步)。但是，使用中等容量或大容量堆运行应用，在双处理器主机上，它通常会比串行收集器表现的稍好。通常在多余两个处理器的主机上，表现得极大超越串行收集器。

并行收集器线程数可以通过命令行选项 -XX:ParallelGCThreads=<N>控制。如果你使用命令行选项优化堆，那么要实现好的性能，并行收集器所需的堆与串行收集器所需的堆一样。但是，启用并行收集器会使收集暂停更短，因为多个垃圾收集器线程会参与到小型收集中，在收集过程中，从年轻代提升到老年代可能会产生一些碎片。参与到小型收集的每个垃圾收集线程预留一部分老年代和一部分可用空间作为这些提升缓冲区，会导致碎片效应。减少垃圾收集线程数并提高老年代容量会减少这种碎片效应。
## <span id="gc6b">并行收集器的分代安排</span>

## <span id="gc6c">并行收集器的人机设计</span>
### <span id="gc6c1">设置并行收集器行为的选项</span>
### <span id="gc6c2">并行收集器目标的优先级</span>
### <span id="gc6c3">并行收集器分代容量调整</span>
### <span id="gc6c4">并行收集器默认堆容量</span>
#### <span id="gc6c4a">并行收集器的初始堆容量和最大堆容量说明</span>
## <span id="gc6d">并行收集器时间过长和内存溢出错误</span>
## <span id="gc6e">衡量并行收集器</span>